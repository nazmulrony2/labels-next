## Problem Analysis (বাংলা): `app/` ফোল্ডারের এই ৩টা ফাইল কেন দরকার?

Next.js App Router-এ `app/` ফোল্ডারটা হলো পুরো ওয়েব অ্যাপের **entry + routing system**।

তোমার এই ৩টা ফাইলের ভূমিকা:

1. `page.tsx` → **হোম পেজের UI + server-side initial data load**
2. `loading.tsx` → **route-level loading UI** (Next.js built-in feature)
3. `layout.tsx` → **global wrapper** (fonts, metadata, global css)

এগুলো বুঝলে তোমার মাথায় “React component tree” পরিষ্কার হবে।

---

## Architecture (বাংলা): Server Component vs Client Component কোথায়?

App Router-এ defaultভাবে:

* `page.tsx` হলো **Server Component** (কারণ এখানে `"use client"` নেই)
* `LabelsApp.client.tsx` হলো **Client Component** (কারণ `"use client"` আছে)

✅ তাই flow হলো:

**Server (`page.tsx`)** → items load করে → **Client (`LabelsApp`)**-এ props হিসেবে পাঠায় → client UI কাজ চালায়।

এটাই best practice: initial load fast + SEO friendly।

---

# 1) `app/page.tsx` — Server-rendered Home Page

## A) Imports

```ts
import LabelsApp from "@/components/LabelsApp.client";
import { getItemsAction } from "@/lib/actions";
import type { RegistryItem } from "@/lib/types";
```

* `LabelsApp` → তোমার main controller UI (client)
* `getItemsAction` → server action call করে initial items আনবে
* `RegistryItem` type → items shape safe

---

## B) `export default async function Page()`

```ts
export default async function Page() {
  const res = await getItemsAction();
  const items: RegistryItem[] = res.ok && res.data ? res.data : [];
  return (...);
}
```

### কেন `async`?

কারণ server-side data fetch করতে হচ্ছে।
App Router-এ Server Component async হতে পারে—এটাই একটা শক্তিশালী feature।

### getItemsAction এখানে call করা safe কেন?

কারণ `page.tsx` server component—server এ run হয়।
`getItemsAction()` ও server action—server-only।

> নোট: Strictly speaking server action সাধারণত client থেকে call হয়, কিন্তু server-side function হিসেবেও ব্যবহার করা যায় (তোমার ক্ষেত্রে কাজ করছে কারণ এটা মূলত server-side helper-এর মতোই)।

---

## C) `items` fallback logic (guard)

```ts
const items: RegistryItem[] = res.ok && res.data ? res.data : [];
```

✅ কেন guard?

* যদি file read fail হয় বা registry missing হয় → `res.ok` false
* তখন page crash না করে empty items নিয়ে app render হবে

---

## D) Render: LabelsApp কে initialItems pass

```tsx
<LabelsApp initialItems={items} />
```

এটাই bridge:

* Server component থেকে data → Client component এ props

Client side:

* LabelsApp তার state initialItems দিয়ে initialize করে
* পরে save/delete হলে server action call করে UI update করে

---

# 2) `app/loading.tsx` — Route-level loading boundary

```ts
export default function Loading() {
  return <div>Loading...</div>;
}
```

### এটা কখন দেখায়?

App Router-এ যখন এই route-এর server-side work চলছে (page load / data fetch / streaming delay), তখন Next.js temporaryভাবে এই component show করতে পারে।

✅ এটা user experience ভালো করে:

* user blank screen দেখে না
* perceived performance improves

---

# 3) `app/layout.tsx` — Global wrapper for all pages

## A) Metadata

```ts
export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};
```

এটা SEO + browser tab title + sharing info ইত্যাদির জন্য।

✅ তুমি চাইলে পরে এখানে তোমার app title “Labels Grid PDF Generator” দিতে পারো।

---

## B) Fonts (Geist)

```ts
const geistSans = Geist({ variable: "--font-geist-sans", subsets: ["latin"] });
const geistMono = Geist_Mono({ variable: "--font-geist-mono", subsets: ["latin"] });
```

এগুলো Next.js font optimization system।
Fonts automatically load, CLS কম হয়।

---

## C) RootLayout wrapper

```tsx
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body className="...">
        {children}
      </body>
    </html>
  );
}
```

### `children` কী?

`children` মানে: এই layout এর ভিতরে যে page/component render হবে।
তোমার ক্ষেত্রে `children` = `Page()` এর output (page.tsx)।

✅ layout একবার define করলে সব পেজ একই wrapper পায়।

---

## Critical Considerations (বাংলা): গুরুত্বপূর্ণ শেখার ৭টা পয়েন্ট

1. `page.tsx` defaultভাবে Server Component (no `"use client"`)
2. `LabelsApp` Client Component, তাই props দিয়ে data পাঠাতে হয়
3. Initial items server-side এ load করলে first load fast হয়
4. `loading.tsx` App Router-এর built-in UX feature
5. `layout.tsx` হলো global template + metadata + fonts
6. Server actions + filesystem access শুধুই server এ হওয়া উচিত—তুমি ঠিকভাবেই আলাদা রেখেছ
7. Guard (`res.ok && res.data`) crash prevent করে

---

## ছোট improvement (optional, কিন্তু nice)

এখন metadata generic আছে। Production-ready করতে:

* title/description meaningful করা
* `<html lang="en">` যদি UI বাংলা হয়, `lang="bn"` করা যায় (optional)

---

এখন পর্যন্ত প্রায় সব শেষ—একটাই core file বাকি:
✅ `lib/pdf.ts`

এটা দিলে আমি তোমার পুরো grid PDF generation algorithm একদম beginner-friendly করে বুঝিয়ে দেব, এবং `preview.ts` এর সাথে mapping করে দেখাব যেন preview বনাম pdf mismatch না হয়।
